#!/bin/bash --login
# This script runs the same sequence as the Docker build
# Run this as:
# bin/setup


# Fail on the first error; killable by SIGINT
set -e
trap "exit" INT

read -p "
------------------------------------------------

Welcome to the SLM Lab setup script;
This will install system dependencies and uv package manager;
Alternatively, inspect bin/setup_ubuntu or bin/setup_macOS and run the lines manually.

Press enter to continue, Ctrl+c to quit:

------------------------------------------------
"

# copy config file if not already exist
BIN_DIR=`pwd`/bin

# Run setup by OS
if [ $(uname) == "Darwin" ]; then
  $BIN_DIR/setup_macOS
elif [ -f '/etc/arch-release' ]; then
  $BIN_DIR/setup_arch
else
  $BIN_DIR/setup_ubuntu
fi

# Extra dependencies no longer supported (Unity/VizDoom deprecated)
if [ "$1" == "extra" ]; then
  echo "Extra dependencies (Unity/VizDoom) are no longer supported."
  echo "Use gymnasium environments directly: https://gymnasium.farama.org/environments/third_party_environments/"
fi

echo "
------------------------------------------------

Installation complete.

------------------------------------------------
"
